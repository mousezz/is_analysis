# 实验5:图书管理系统数据库设计与界面设计
|  姓名  |      学号      |     班级      |
| :--: | :----------: | :---------: |
|  谢颜浩  | 201510414221 | 软工2班 |

## 1.数据库表设计

## 1.1. 预约书籍表
|字段|类型|主键，外键|可以为空|默认值|约束|说明|
|:-------:|:-------------:|:------:|:----:|:---:|:----:|:-----|
|BookNo|varchar2(32)||否| | | 预约的书籍|
|PersonNo|varchar2(60)|主键 |否|||预约的人员|
|BookingTime|varchar2(50)| |否|||预约时间|

## 1.2. 借出书籍表
|字段|类型|主键，外键|可以为空|默认值|约束|说明|
|:-------:|:-------------:|:------:|:----:|:---:|:----:|:-----|
|BookNo|varchar2(32)|主键、外键|否|||图书编号|
|PersonNo|varchar2(32)| 外键|否| ||借书人员|
|LendTime|varchar2(32)| |否| | |借书时间|
|LeastTime|varchar2(32)| |否| | |还书时间|

## 1.3. 归还书籍表
|字段|类型|主键，外键|可以为空|默认值|约束|说明|
|:-------:|:-------------:|:------:|:----:|:---:|:----:|:-----|
|BookNo|varchar2(32)|主键、外键|否|||图书编号|
|PersonNo|varchar2(32)|外键 |否| | |归还人员|
|ReturnTime|varchar2(32)| |否| | |归还时间 |
|Fine|varchar2(32)| |是| | |如果超期则增加罚金| 

## 1.4. 书籍表
|字段|类型|主键，外键|可以为空|默认值|约束|说明|
|:-------:|:-------------:|:------:|:----:|:---:|:----:|:-----|
|BookNo|varchar2(32)|主键、外键|否|| |图书编号|
|BookName|varchar2(50)| |否| | |图书名称|
|Arthur|varchar2(32)| |否| | |作者|
|ISBN|varchar2(32)||否|| |条形码|
|Publish|varchar2(50)| |否| | |出版社|
|price|varchar2(10)| |否| | |价格|
|BookState|varchar2(50)| |否| | |学生专业|
|BookClass|varchar2(32)| |否| | |学生年级|
## 1.5. 借书卡表
|字段|类型|主键，外键|可以为空|默认值|约束|说明|
|:-------:|:-------------:|:------:|:----:|:---:|:----:|:-----|
|CardNo|varchar2(32)|主键|否| ||一卡通|
|PersonNo|varchar2(50)| |否| | |预约的人员|
|LostTag|varchar2(50)| |否| | ||

## 1.6. 借书者表
|字段|类型|主键，外键|可以为空|默认值|约束|说明|
|:-------:|:-------------:|:------:|:----:|:---:|:----:|:-----|
|PersonNo|varchar2(32)|主键|否| | |预约的人员|
|Password|varchar2(32)||否| ||密码|
|PersonInfo|varchar2(14)||否| ||人员信息|
## 1.7. 普通管理员表
|字段|类型|主键，外键|可以为空|默认值|约束|说明|
|:-------:|:-------------:|:------:|:----:|:---:|:----:|:-----|
|AdminID|varchar2(32)|主键|否| | |管理员账号|
|Password|varchar2(32)||否| |密码||

## 1.8. 系统管理员表
|字段|类型|主键，外键|可以为空|默认值|约束|说明|
|:-------:|:-------------:|:------:|:----:|:---:|:----:|:-----|
|RootId|varchar2(32)|主键|否| | |超级管理员|
|Password|varchar2(32)|外键|否| |密码||

***

## 2. 界面设计
## 2.1. 图书归还界面设计
![pic1](pic.PNG)
- 用例图参见：图书归还用例
- 类图参见：Book类，Reader类，LendRecord类
- 顺序图参见：图书归还顺序图
- API接口如下：

1. 获取用户未归还图书API

- 功能：用于获取某用户全部未归还图书
- 请求地址： http://localhost/v1/api/get_unreturnbooks_4reader
- 请求方法：POST
- 请求参数：

|参数名称|必填|说明|
|:-------:|:-------------: | :----------:|
|userID|是|根据读者编号获取其未归还图书列表 |

- 返回实例：
```
{
	"unreturnbooks_4reader": [{
		"ISBN": "9787513506915",
		"bookname": "翻译美学理论",
		"author": "刘宓庆",
		"startDate": "2018-03-03",
		"isRenew": "true,
		"activeTime": 30,
		"returnDate": null
	}, {
        "ISBN": "9787544627634",
		"bookname": "翻译能力培养",
		"author": "舍夫纳",
		"startDate": "2018-03-15",
		"isRenew": true,
		"activeTime": 30,
		"returnDate": null
	}, {
        "ISBN": "9787310028306",
		"bookname": "当代国外翻译理论导读",
		"author": "谢天振",
		"startDate": "2018-04-21",
		"isRenew": false,
		"activeTime": 30,
		"returnDate": null
	}],
    "readerLendBook": {
        "userID": "201510418736",
        "username": "螺蛳粉",
        "major": "食品加工",
        "grade": "2015级"
    },
	"length": 3,
	"status": 1
}
```
- 返回参数说明：
    
|参数名称|说明|
|:-------:|:-------------: |
|unreturnbooks_4reader|该用户未归还图书的集合|
|readerLendBook|该读者的用户信息|
|length|未归还图书集合的长度|
|status|获取结果，为1时表示成功获取，为0时表示获取失败|

2. 归还图书API
- 功能：用于向系统提交需要归还的图书项目
- 请求地址： http://localhost/v1/api/return_books
- 请求方法：POST
- 请求参数：

|参数名称|必填|说明|
|:-------:|:-------------: | :----------:|
|userID|是|根据读者编号归还其借阅图书 |
|ISBN|是|待归还图书的ISBN号 |

- 返回实例：
```
{
	"length": 2,
	"status": 1
}
```
- 返回参数说明：
    
|参数名称|说明|
|:-------:|:-------------: |
|length|成功归还图书数量|
|status|获取执行结果，为1时表示都成功执行，为0时表示存在执行失败|


 
