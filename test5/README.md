# 实验5:图书管理系统数据库设计与界面设计
 |     班级      |
| :---------: |
| 软工2班 |

## 1.数据库表设计

## 1.1. 预约书籍表
|字段|类型|主键，外键|可以为空|默认值|约束|说明|
|:-------:|:-------------:|:------:|:----:|:---:|:----:|:-----|
|BookNo|varchar2(32)||否| | | 预约的书籍|
|PersonNo|varchar2(60)|主键 |否|||预约的人员|
|BookingTime|varchar2(50)| |否|||预约时间|

## 1.2. 借出书籍表
|字段|类型|主键，外键|可以为空|默认值|约束|说明|
|:-------:|:-------------:|:------:|:----:|:---:|:----:|:-----|
|BookNo|varchar2(32)|主键、外键|否|||图书编号|
|PersonNo|varchar2(32)| 外键|否| ||借书人员|
|LendTime|varchar2(32)| |否| | |借书时间|
|LeastTime|varchar2(32)| |否| | |还书时间|

## 1.3. 归还书籍表
|字段|类型|主键，外键|可以为空|默认值|约束|说明|
|:-------:|:-------------:|:------:|:----:|:---:|:----:|:-----|
|BookNo|varchar2(32)|主键、外键|否|||图书编号|
|PersonNo|varchar2(32)|外键 |否| | |归还人员|
|ReturnTime|varchar2(32)| |否| | |归还时间 |
|Fine|varchar2(32)| |是| | |如果超期则增加罚金| 

## 1.4. 书籍表
|字段|类型|主键，外键|可以为空|默认值|约束|说明|
|:-------:|:-------------:|:------:|:----:|:---:|:----:|:-----|
|BookNo|varchar2(32)|主键、外键|否|| |图书编号|
|BookName|varchar2(50)| |否| | |图书名称|
|Arthur|varchar2(32)| |否| | |作者|
|ISBN|varchar2(32)||否|| |条形码|
|Publish|varchar2(50)| |否| | |出版社|
|price|varchar2(10)| |否| | |价格|
|BookState|varchar2(50)| |否| | |学生专业|
|BookClass|varchar2(32)| |否| | |学生年级|
## 1.5. 借书卡表
|字段|类型|主键，外键|可以为空|默认值|约束|说明|
|:-------:|:-------------:|:------:|:----:|:---:|:----:|:-----|
|CardNo|varchar2(32)|主键|否| ||一卡通|
|PersonNo|varchar2(50)| |否| | |预约的人员|
|LostTag|varchar2(50)| |否| | ||

## 1.6. 借书者表
|字段|类型|主键，外键|可以为空|默认值|约束|说明|
|:-------:|:-------------:|:------:|:----:|:---:|:----:|:-----|
|PersonNo|varchar2(32)|主键|否| | |预约的人员|
|Password|varchar2(32)||否| | |密码|
|PersonInfo|varchar2(14)||否| ||人员信息|
## 1.7. 普通管理员表
|字段|类型|主键，外键|可以为空|默认值|约束|说明|
|:-------:|:-------------:|:------:|:----:|:---:|:----:|:-----|
|AdminID|varchar2(32)|主键|否| | |管理员账号|
|Password|varchar2(32)||否| ||密码|

## 1.8. 系统管理员表
|字段|类型|主键，外键|可以为空|默认值|约束|说明|
|:-------:|:-------------:|:------:|:----:|:---:|:----:|:-----|
|RootId|varchar2(32)|主键|否| | |超级管理员|
|Password|varchar2(32)|外键|否| | |密码|

***

## 2. 界面设计
## 2.1. 图书归还界面设计
![pic1](pic.PNG)
- 用例图参见：图书归还用例
- 类图参见：Book类，Reader类，LendRecord类
- 顺序图参见：图书归还顺序图
- API接口如下：

1. 获取用户未归还图书API

- 功能：用于获取某用户全部未归还图书
- 请求地址： http://mousess/v001/api/testbook
- 请求方法：POST
- 请求参数：

|参数名称|必填|说明|
|:-------:|:-------------: | :----------:|
|BookNo|是|图书编号|
|PersonNo|是| 借书人员|
|LendTime|是| 借书时间|
|LeastTime|是)| 还书时间|


## 1.2. 借出书籍表

- 返回实例：
```
{
	"testbook": [{
		"BookNo": "2011205",
		"PersonNo": "201510414069,
		"LendTime": 2018-04-20,
		"LeastTime": 2018-05-20
	}, {
		"BookNo": "2011201",
		"PersonNo": "201510414229,
		"LendTime": 2018-06-16,
		"LeastTime": 2018-07-16
	}, {
		"BookNo": "20112033",
		"PersonNo": "201510414219,
		"LendTime": 2018-05-16,
		"LeastTime": 2018-06-16
	}],
	   "readerLendBook": {
        "userID": "201820151012",
        "username": "张郭",
        "major": "软件工程",
        "grade": "2018级"
    },
	"length": 3,
	"status": 1
}
```
- 返回参数说明：
    
|参数名称|说明|
|:-------:|:-------------: |
|reader|该用户未归还图书的集合|
|LendBook|该读者的用户信息|
|length|未归还图书集合的数目|
|status|获取结果，为1时表示成功获取，为0时表示获取失败|

2. 归还图书API
- 功能：用于向系统提交需要归还的图书项目
- 请求地址： http://mousess/v001/api/return_book
- 请求方法：POST
- 请求参数：

|参数名称|说明|
|:-------:|:-------------: |
|BookNo|归还的图书名称|
|PersonNo|归还的人员|
|ReturnTime|归还图书时间|
|Fine|是否欠缴金额,并且返回|

- 返回实例：
```
{
	"BookNo": 1,
	"PersonNo": 1
	"ReturnTime": 1
	"Fine": 1
}
```
- 返回参数说明：
    
|参数名称|说明|
|:-------:|:-------------: |
|BookNo|成功归还图书返回1,如果存在欠费,则先处理欠费,处理成功返回1,失败返回0|
|PersonNo|查询是否存在此人,存在返回1,失败为0|
|ReturnTime|记录归还时间,是否超过应当归还时间,不超过返回1,超过返回2,跳转到Fine|
|Fine|是否存在欠款,如果存在则缴纳,如果缴纳失败,则归还失败返回0,成功返回1,不存在欠费则为2|
